---
title: "spud"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
df = read.csv("trial.csv")
#rename some columns
# pre_ is weekly consumption before they watch the video
# post_ is weekly plan for next week

names(df)[names(df) == 'q10_5_text'] <- 'pre_beef'
names(df)[names(df) == 'q11_5_text'] <- 'post_beef'
names(df)[names(df) == 'q10_6_text'] <- 'pre_pork'
names(df)[names(df) == 'q11_6_text'] <- 'post_pork'
names(df)[names(df) == 'q9'] <- 'sex'
summary(df)

# remember, video_type:  "F" => feedlot, "P" => Pasture, "I" => Irrigation
# Create a new column "vegetarian" for those who never eat meat before or after treatment
mean(df$pre_beef)
mean(df$post_beef)
mean(df$post_beef[df$sex=="Male"])
mean(df$post_beef[df$sex=="Female"])
mean(df$post_beef[df$sex=="Female" & df$video_type=="F"])
mean(df$post_beef[df$sex=="Female" & df$video_type=="P"])
mean(df$post_beef[df$sex=="Female" & df$video_type=="I"])
# try a simple regression; set male and Irrigation video as reference levels for those factors
df$sex <-relevel(df$sex, ref = "Male")
df$video_type <-relevel(df$video_type, ref = "I")
df$vegetarian <- (df$pre_beef == 0) & (df$post_beef == 0) & (df$pre_pork == 0) & (df$post_pork == 0)
model1 = lm( post_beef ~ pre_beef + vegetarian + factor(sex)*factor(video_type)*vegetarian, data=df)
summary(model1)
```